---

- name: download tomcat binary to local folder
  become: false
  get_url:
    url: "{{ tomcat_download_url }}"
    dest: "/tmp/apache-tomcat-{{ tomcat_version }}.tar.gz"
  register: _download_archive
  until: _download_archive is succeeded
  retries: 5
  delay: 2
  run_once: true
  delegate_to: localhost
  check_mode: false
  tags:
    - tomcat

- name: propagate tomcat archiv
  copy:
    src: "/tmp/apache-tomcat-{{ tomcat_version }}.tar.gz"
    dest: /tmp
  tags:
    - tomcat

- name: propagate jar files
  copy:
    src: "{{ item.src }}"
    dest: /tmp/
    checksum: "{{ item.checksum }}"
  with_items:
    "{{ tomcat_files }}"
  tags:
    - tomcat
